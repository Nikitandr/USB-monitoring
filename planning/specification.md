# Техническое задание: Система безопасности USB-устройств

## 1. Общее описание проекта

### 1.1 Назначение системы
Система предназначена для контроля и мониторинга подключения USB-устройств в корпоративной сети с целью обеспечения информационной безопасности.

### 1.2 Цели проекта
- Предотвращение несанкционированного подключения USB-устройств
- Централизованное управление разрешениями на USB-устройства
- Мониторинг и аудит подключений USB-устройств
- Уведомление администратора о попытках подключения неразрешенных устройств

### 1.3 Область применения
- Корпоративные сети с рабочими станциями на Linux Ubuntu 22.04
- Административный веб-интерфейс доступен с любой машины через браузер
- Центральный сервер развертывается в Docker-контейнере на Linux
- Проект является proof-of-concept, не предназначен для промышленного использования

## 2. Функциональные требования

### 2.1 Основные функции системы

#### 2.1.1 Контроль автомонтирования
- Система должна полностью отключить стандартное автомонтирование USB-устройств в ОС на рабочей станции
- Система должна взять на себя процесс контролируемого монтирования устройств на рабочей станции

#### 2.1.2 Идентификация устройств
- Система должна идентифицировать USB-устройства по уникальным параметрам:
  - VID (Vendor ID)
  - PID (Product ID) 
  - Serial Number
- Система должна определять активного пользователя сессии

#### 2.1.3 Управление белыми списками
- Каждый пользователь должен иметь персональный белый список разрешенных устройств
- Белые списки должны храниться централизованно
- Пользователи НЕ имеют доступа к просмотру или изменению своих белых списков
- Управление белыми списками осуществляется только администратором

#### 2.1.4 Процесс авторизации устройств
- При подключении разрешенного устройства - автоматическое монтирование
- При подключении запрещенного устройства - блокировка без уведомлений
- При подключении неизвестного устройства - запрос администратору на разрешение

#### 2.1.5 Административные функции
- Просмотр всех запросов на подключение устройств через веб-интерфейс
- Одобрение/отклонение запросов в реальном времени
- Управление белыми списками пользователей
- Просмотр истории подключений и действий
- Уведомления пользователям о статусе их запросов

#### 2.1.6 Обработка недоступности сервера
- При недоступности центрального сервера система должна запрещать подключение всех USB-устройств
- Пользователь должен получать уведомление об ошибке соединения с сервером
- Система должна периодически пытаться восстановить соединение

#### 2.1.7 Обработка устройств при запуске системы
- Автомонтирование должно быть отключено на системном уровне
- При запуске демона система должна проверить уже подключенные USB-устройства
- Уже подключенные устройства должны быть обработаны согласно политикам безопасности

### 2.2 Пользовательские сценарии

#### 2.2.1 Сценарий подключения разрешенного устройства
1. Пользователь подключает USB-устройство
2. Система идентифицирует устройство и пользователя
3. Система проверяет белый список пользователя
4. Устройство автоматически монтируется
5. Пользователь получает доступ к устройству

#### 2.2.2 Сценарий подключения неизвестного устройства
1. Пользователь подключает неизвестное USB-устройство
2. Система идентифицирует устройство и пользователя
3. Система создает запрос администратору
4. Администратор получает уведомление с информацией о пользователе и устройстве
5. Администратор принимает решение об одобрении/отклонении
6. Система выполняет соответствующее действие

## 3. Технические требования

### 3.1 Архитектура системы
- Клиент-серверная архитектура
- Централизованное хранение данных
- RESTful API для взаимодействия компонентов
- WebSocket для уведомлений в реальном времени

### 3.2 Компоненты системы

#### 3.2.1 Central Server (Центральный сервер)
- **Платформа**: Linux (Docker-контейнер)
- **Язык разработки**: Python 3.8+
- **Веб-фреймворк**: Flask или FastAPI
- **База данных**: SQLite
- **Функции**:
  - REST API для управления устройствами и разрешениями
  - Обработка запросов на разрешения
  - WebSocket сервер для уведомлений
  - Веб-интерфейс для администратора
  - Простая аутентификация администратора

#### 3.2.2 Linux Client Daemon (Клиентский демон)
- **Платформа**: Linux Ubuntu 22.04
- **Язык разработки**: Python 3.8+
- **Тип**: Системный демон (systemd service)
- **Основные библиотеки**: pyudev, pydbus, PyGObject, requests
- **Функции**:
  - Автозапуск при загрузке ОС
  - Мониторинг USB-событий через udev
  - Контроль монтирования через UDisks2 D-Bus API
  - Взаимодействие с центральным сервером
  - Локальное кэширование разрешений
  - Уведомления пользователям о статусе запросов

### 3.3 Требования к безопасности
- HTTP соединения (HTTPS не требуется для упрощения)
- Простая аутентификация администратора
- Логирование всех действий для аудита (средний уровень детализации)
- Защита от SQL-инъекций

### 3.4 Требования к производительности
- Время отклика на запрос разрешения: не более 2 секунд
- Поддержка до 100 одновременных клиентов
- Время обработки USB-события: не более 1 секунды
- Размер базы данных: до 1 ГБ

### 3.5 Требования к надежности
- Запрет подключений при недоступности сервера с уведомлением пользователю
- Автоматическое восстановление соединения
- Обработка ошибок без критических сбоев
- Логирование ошибок для диагностики
- Автозапуск демона при загрузке системы

## 4. Развертывание и установка

### 4.1 Требования к инфраструктуре
- Центральный сервер: Linux сервер с Docker
- Клиентские машины: Ubuntu 22.04 с правами sudo для установки
- Административный доступ: любая машина с веб-браузером
- Сетевое соединение между всеми компонентами

### 4.2 Процесс установки
1. Развертывание центрального сервера в Docker-контейнере
2. Настройка базы данных и создание учетной записи администратора
3. Установка клиентского демона на рабочие станции
4. Настройка системных правил (udev, polkit) для отключения автомонтирования
5. Настройка автозапуска демона (systemd service)
6. Тестирование системы

## 5. Архитектурные решения

### 5.1 Клиентская часть
- Реализация в виде системного демона (systemd service)
- Автозапуск при загрузке операционной системы
- Отключение автомонтирования на системном уровне

### 5.2 Серверная часть
- Развертывание в Docker-контейнере на Linux
- Веб-интерфейс администратора как часть серверного приложения
- Простая аутентификация администратора

### 5.3 Управление разрешениями
- Пользователи не имеют доступа к своим белым спискам
- Все управление осуществляется администратором через веб-интерфейс
- Уведомления пользователям о статусе их запросов
